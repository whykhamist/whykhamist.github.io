import{a as N,r as Y,c as F,o as E,b as i,d as a,e as h,f as u,k as H,l as d,s as n,Q as K,g as V,t as g,m as o,p as m,I as $,P as S,ac as O,h as R,j as P}from"./index-X5AUvwv7.js";const q=n("span",{class:"sr-only"},"Press escape to close",-1),L=n("span",{"aria-hidden":"true"},"esc",-1),Q=[q,L],A={class:"mb-2 flex items-center text-sm leading-none"},G={class:"flex flex-auto gap-1"},J={key:0,class:"origin-center select-none rounded-full border bg-gray-300 px-3 shadow-sm hover:scale-105 dark:bg-gray-500 dark:shadow-white"},W={key:1,class:"origin-center select-none rounded-full border bg-gray-300 px-3 shadow-sm hover:scale-105 dark:bg-gray-500 dark:shadow-white"},X={key:0,class:"flex flex-col gap-2 rounded-md border bg-slate-100 p-2 dark:bg-slate-700"},Z={key:0,class:"flex flex-col rounded-2xl border bg-slate-50 px-3 dark:bg-slate-500"},ee=n("div",{class:"flex-auto select-none text-sm uppercase opacity-50"}," Search By: ",-1),le={class:"grid grid-cols-12 gap-2 p-2"},te={key:1,class:"flex flex-col rounded-2xl border bg-slate-50 px-3 dark:bg-slate-500"},se=n("div",{class:"flex-auto select-none text-sm uppercase opacity-50"}," Filter: ",-1),ae={class:"grid grid-cols-12 gap-2 p-2"},ne={key:1,class:"flex flex-col gap-2 rounded-md border p-2"},oe={key:0,class:"flex-auto text-center font-semibold italic text-gray-400/75"},re=["onClick"],de={class:"flex items-center px-2 leading-none"},ce={class:"flex flex-auto flex-col justify-center leading-none"},ie={class:"flex flex-col-reverse gap-1 pr-3 leading-none md:flex-row md:items-center"},ue={class:"px-1 text-xs leading-none"},me={class:"flex flex-wrap gap-2 px-1 leading-none md:border-l"},fe={key:0,class:"rounded-full border bg-gray-500/50 px-2 py-1 text-xs leading-none shadow"},ge={key:1,class:"rounded-full border bg-gray-500/50 px-2 py-1 text-xs leading-none shadow"},pe={class:"flex items-center px-3"},be={__name:"tSearcher",props:{store:Object,title:{type:String,default:""},closable:{type:Boolean,default:!1},columns:{type:Object,default:()=>[]},filters:{type:Object,default:()=>[]}},emits:["search","close"],setup(r,{emit:M}){const x=r,b=M,B=N(null),t=Y({search:"",column:null,filter:null,settings:!1}),k=F(()=>C(t.column)),y=F(()=>w(t.filter)),C=s=>x.columns.find(e=>e.value==s),w=s=>x.filters.find(e=>e.value==s),T=(s=null)=>{let e={search:(s==null?void 0:s.search)??t.search,column:(s==null?void 0:s.column)??t.column,filter:(s==null?void 0:s.filter)??t.filter};x.store.addHistory(e),b("search",e)};return E(()=>{var s,e,f;(f=(e=(s=B.value)==null?void 0:s.$el)==null?void 0:e.firstElementChild)==null||f.focus(),x.columns.forEach(v=>{v.default&&(t.column=v.value)})}),(s,e)=>{const f=i("TIcon"),v=i("TInput"),I=i("TCardHeader"),_=i("TButton"),j=i("TRadio"),U=i("TCardBody"),z=i("TCardFooter"),D=i("TCard");return a(),h(D,{class:"mt-20 max-h-[calc(95vh_-_8rem)] w-[95dvw] max-w-[596px] bg-background-accent text-foreground",onKeyup:e[6]||(e[6]=H(c=>b("close"),["esc"])),tabindex:"-1"},{default:u(()=>[d(I,{class:"border-b-0 pt-3",ref_key:"headerComponent",ref:B},{default:u(()=>[d(v,{modelValue:t.search,"onUpdate:modelValue":e[1]||(e[1]=c=>t.search=c),label:`Search ${r.title}`,class:"w-full !pb-0",innerClass:"bg-light text-dark",onKeyup:e[2]||(e[2]=H(c=>T(null),["enter"]))},K({prepend:u(()=>[d(f,{name:"search"})]),_:2},[r.closable?{name:"append",fn:u(()=>[n("button",{tabindex:"-1",class:"rounded border px-1 text-xs uppercase shadow-inner hover:bg-gray-300/25",onClick:e[0]||(e[0]=c=>b("close")),role:"button"},Q)]),key:"0"}:void 0]),1032,["modelValue","label"])]),_:1},512),d(U,{class:"min-h-[12rem] overflow-auto"},{default:u(()=>{var c;return[n("div",A,[n("div",G,[n("span",{class:V(["mr-2 pr-2",[(!!y.value||!!k.value)&&"border-r"]])},g(t.settings?"Settings":"Recent"),3),t.filter&&y.value?(a(),o("span",J,g(y.value.label),1)):m("",!0),t.column&&k.value?(a(),o("span",W,g(k.value.label),1)):m("",!0)]),r.columns.length>0||r.filters.length>0?(a(),h(_,{key:0,onClick:e[3]||(e[3]=l=>t.settings=!t.settings)},{default:u(()=>[d(f,{name:"settings",size:"sm",class:V(["origin-center select-none leading-none transition-all hover:scale-105",[t.settings&&"text-gray-700 dark:text-gray-100",!t.settings&&"text-gray-400"]])},null,8,["class"])]),_:1})):m("",!0)]),t.settings?(a(),o("div",X,[r.columns.length>0?(a(),o("div",Z,[ee,n("div",le,[(a(!0),o($,null,S(r.columns,l=>(a(),h(j,{key:`search_col_${l.label}`,modelValue:t.column,"onUpdate:modelValue":p=>t.column=p,class:"col-span-4",value:l.value,label:l.label,name:"column"},null,8,["modelValue","onUpdate:modelValue","value","label"]))),128))])])):m("",!0),r.filters.length>0?(a(),o("div",te,[se,n("div",ae,[(a(!0),o($,null,S(r.filters,l=>(a(),h(j,{key:`user_filter_${l.value}`,modelValue:t.filter,"onUpdate:modelValue":p=>t.filter=p,class:"col-span-4",value:l.value,label:l.label,name:"filter"},null,8,["modelValue","onUpdate:modelValue","value","label"]))),128))])])):m("",!0)])):(a(),o("div",ne,[((c=r.store.getSearchHistory)==null?void 0:c.length)<=0?(a(),o("div",oe," No recent search! ")):m("",!0),(a(!0),o($,null,S(r.store.getSearchHistory,l=>(a(),o("div",{key:`user_search_history_${l.timestamp}`,class:"flex cursor-pointer items-center rounded-md border bg-slate-300 py-2 leading-none transition-colors hover:bg-slate-800/75 hover:text-slate-50 dark:bg-slate-600/75 dark:hover:bg-slate-900/75",onClick:p=>T(l)},[n("div",de,[d(f,{name:"history",size:"lg",class:"text-gray-400"})]),n("div",ce,[n("div",{class:V(["leading-none",[!l.search&&"text-xs italic leading-none",!!l.search&&"text-xl font-semibold"]])},g(l.search?l.search:"(empty)"),3),n("div",ie,[n("div",ue,g(R(O)(l.timestamp).format("MMMM DD, YYYY hh:mm:ss a")),1),n("div",me,[w(l.filter)?(a(),o("span",fe,g(w(l.filter).label),1)):m("",!0),C(l.column)?(a(),o("span",ge,g(C(l.column).label),1)):m("",!0)])])]),n("div",pe,[d(_,{class:"aspect-square rounded-full p-1",onClick:P(p=>r.store.removeHistory(l),["prevent","stop"])},{default:u(()=>[d(f,{name:"close",size:"sm"})]),_:2},1032,["onClick"])])],8,re))),128))]))]}),_:1}),d(z,{class:"flex items-center justify-end gap-1"},{default:u(()=>[d(_,{onClick:e[4]||(e[4]=c=>T(null)),class:"overflow-auto rounded-full border bg-primary bg-glossy px-3 py-2 text-white shadow-md transition-colors",label:"Search"}),d(_,{onClick:e[5]||(e[5]=c=>b("close")),class:"overflow-auto rounded-full px-3 py-2",label:"Cancel"})]),_:1})]),_:1})}}};export{be as default};
