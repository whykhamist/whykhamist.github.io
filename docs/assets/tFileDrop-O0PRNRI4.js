import{c as D,b as T,d as r,m as i,l as p,f as v,g as m,I as B,t as b,s as u,T as C,q as y,v as O,x as U,P as q,ae as G,W as S,h as H,p as k,y as P,j as h,af as W,ag as Z,ah as K}from"./index-X5AUvwv7.js";import L from"./fileInfo--_db8Fl3.js";import{_ as J}from"./_plugin-vue_export-helper-x3n3nnut.js";const Q=t=>(Z("data-v-172d9ae1"),t=t(),K(),t),X=["onDrop"],Y={class:"italic leading-none transition-all"},_={key:1,class:"flex w-full items-center"},ee=Q(()=>u("div",{class:"flex-auto"},"Uploading files(s), please wait...",-1)),te={key:0,class:"absolute inset-x-0 bottom-0 flex h-5 items-center"},le={class:"flex w-full items-center gap-1 px-2 text-xs text-gray-400"},ae={class:"flex-auto"},se={key:0,class:"absolute inset-x-0 bottom-0 translate-y-full px-2 pt-1 text-[11px] leading-none"},ne={key:0,class:"absolute left-2 right-0 top-0.5 mt-0.5 text-[11px] font-semibold leading-none"},oe={class:"rounded-full border-negative px-1 leading-tight text-negative dark:border dark:bg-negative/75 dark:text-light"},re={key:1,class:"absolute inset-x-2 top-1 text-[11px] leading-none text-gray-400"},ie={key:1,class:"pointer-events-auto absolute inset-0 cursor-not-allowed"},A=/^\.[a-zA-Z]{3,4}(,\.[a-zA-Z]{3,4})*$/,de={__name:"tFileDrop",props:{modelValue:Object,disabled:{type:Boolean,default:!1},accept:{type:String,default:null,validator:t=>(A.test(t.replaceAll(" ","")),!0)},multiple:{type:Boolean,default:!1},allowDuplicates:{type:Boolean,default:!1},prepend:{type:Boolean,default:!1},alwaysReplace:{type:Boolean,default:!1},uploading:{type:Boolean,default:!1},hint:{type:String,default:null},error:{type:Boolean,default:null},errorMessage:{type:String,default:null}},emits:["update:modelValue"],setup(t,{emit:$}){const n=t,g=$,o=D({get:()=>n.modelValue,set:e=>g("update:modelValue",e)}),M=D(()=>{let e=0;return o.value.forEach(l=>{e+=l.file.size}),e}),E=()=>{let e=document.createElement("input");e.type="file",e.multiple=n.multiple,e.accept=n.accept??"*",e.onchange=l=>{w([...l.target.files])},e.click()},z=e=>{w([...e.dataTransfer.files])},w=e=>{if(!n.disabled&&!n.uploading){let l=n.alwaysReplace?[]:n.modelValue,a=R(e);n.multiple?n.prepend?l.unshift(...a.reverse()):l.push(...a):l=a[0]?[a[0]]:[],g("update:modelValue",l)}},V=e=>{if(n.multiple){let l=[...n.modelValue];l=l.filter(a=>a.id!==e),g("update:modelValue",l)}else g("update:modelValue",[])},R=e=>{let l=[];for(let a of e)j(a,n.accept)&&!I(a)&&l.push(N(a));return l},I=e=>!!o.value.find(l=>l.file.name==e.name),F=(e,l)=>{let a=o.value.map(c=>(c.id==l&&(c.rename=e),c));g("update:modelValue",a)},N=e=>({id:S.uniqid(),progress:0,rename:e.name,file:e}),j=(e,l)=>{if(n.accept){let a=n.accept.replaceAll(" ","").split(",");a=a.filter(f=>A.test(f));let c=W.extractExtension(e.name);return!!a.find(f=>f==`.${c}`)}return!0};return(e,l)=>{var f;const a=T("TButton"),c=T("TSpinnerCircles");return r(),i("div",{class:m(["group relative flex flex-col gap-1 border-4 border-dashed border-gray-400/75 pb-5 pt-10 transition-colors",[(t.disabled||t.uploading)&&"pointer-events-none",t.disabled&&" !bg-gray-200",!t.disabled&&"hover:border-foreground/7",t.error!=null&&"mb-5",t.error&&"border-negative/50 hover:border-negative "]]),onDragenter:l[0]||(l[0]=h(()=>{},["prevent"])),onDragover:l[1]||(l[1]=h(()=>{},["prevent"])),onDragleave:l[2]||(l[2]=h(()=>{},["prevent"])),onDrop:h(z,["prevent"])},[p(C,{enterActiveClass:"transition-all",leaveActiveClass:"transition-all",enterFromClass:"opacity-0",leaveToClass:"opacity-0"},{default:v(()=>{var s,d,x;return[u("div",{class:m(["pointer-events-none absolute flex select-none items-center justify-center text-sm font-bold uppercase transition-all md:text-base",[((s=o.value)==null?void 0:s.length)<=0&&"inset-0 flex-col",((d=o.value)==null?void 0:d.length)>0&&"inset-x-0 top-0  rounded-lg border-b border-slate-500/50 px-2 py-2"]])},[t.uploading?(r(),i("div",_,[ee,u("div",null,[p(c,{class:"h-4 w-4"})])])):(r(),i(B,{key:0},[u("div",Y," Drag N' Drop File"+b(t.multiple?"s":"")+" here ",1),u("div",{class:m(["transition-all",[((x=o.value)==null?void 0:x.length)>0&&"flex-auto text-center"]])}," OR ",2),p(a,{label:"Browse",class:m(["rounded-full border border-slate-500/50 bg-foreground bg-glossy px-3 py-1 uppercase text-background",[!t.disabled&&!t.uploading&&"pointer-events-auto"]]),onClick:E},null,8,["class"])],64))],2)]}),_:1}),p(G,{tag:"div",name:"files",class:m(["relative flex flex-col gap-1",[!!((f=o.value)!=null&&f.length)&&"p-1"]])},{default:v(()=>[(r(!0),i(B,null,q(o.value,s=>U((r(),i("div",{key:s.id,class:"w-full border-2 border-foreground/25 leading-none"},[y(e.$slots,"default",{file:s.file,readonly:t.disabled,removeFn:()=>V(s.id),renameFn:d=>F(d,s.id),progress:s.progress},()=>[p(L,{rename:s.rename,"onUpdate:rename":d=>F(d,s.id),file:s.file,onRemove:d=>V(s.id),readonly:t.disabled||t.uploading,progress:s.progress},{actions:v(({file:d,progress:x})=>[y(e.$slots,"actions",{file:d,progress:x},void 0,!0)]),_:2},1032,["rename","onUpdate:rename","file","onRemove","readonly","progress"])],!0)])),[[O,s.progress<=100]])),128))]),_:3},8,["class"]),p(C,{enterActiveClass:"transition-all",leaveActiveClass:"transition-all",enterFromClass:"opacity-0",leaveToClass:"opacity-0"},{default:v(()=>{var s;return[((s=o.value)==null?void 0:s.length)>0?(r(),i("div",te,[u("div",le,[u("div",ae,b(`${o.value.length} file${o.value.length>1?"s":""} selected`),1),u("div",null,b(H(S).formatFileSize(M.value)),1)])])):k("",!0)]}),_:1}),t.error!=null&&t.errorMessage!=null||t.hint!=null?(r(),i("div",se,[p(C,{enterFromClass:"opacity-0 -translate-y-full",leaveToClass:"opacity-0 -translate-y-full",enterActiveClass:"transition duration-300",leaveActiveClass:"transition duration-300"},{default:v(()=>[t.error?(r(),i("div",ne,[y(e.$slots,"errorMessage",{error:t.error,errorMessage:t.errorMessage},()=>[u("span",oe,b(t.errorMessage),1)],!0)])):(r(),i("div",re,[y(e.$slots,"hint",{hint:t.hint},()=>[P(b(t.hint),1)],!0)]))]),_:3})])):k("",!0),t.disabled?(r(),i("div",ie)):k("",!0)],42,X)}}},fe=J(de,[["__scopeId","data-v-172d9ae1"]]);export{fe as default};
